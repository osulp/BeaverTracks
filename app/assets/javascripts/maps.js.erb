// window.map_hash needs to be set in the view

// this check is necessary to see if the page is fully loaded before executing
// http://stackoverflow.com/questions/5478450/google-map-error-a-is-null
$(document).ready(function () {

  if ($('body.maps').length > 0) {

    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){

      markers = handler.addMarkers(window.map_hash);

      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(16);
    });
  }

});
